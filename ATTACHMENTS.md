# Приложения к нормативным документам

Система поддерживает приложения к нормативным документам, которые могут содержать графические материалы, таблицы, схемы и другие файлы.

## Структура хранения приложений

Приложения хранятся в директориях рядом с документом. Поддерживаются следующие варианты имен директорий:

1. `приложения/` - стандартное имя (рекомендуется)
2. `attachments/` - альтернативное имя
3. `{имя_документа}_приложения/` - специфичное для документа
4. `{имя_документа}_attachments/` - специфичное для документа

### Пример структуры:

```
documents/
  └── ООО ФК РАНА/
      └── Отдел информационных технологий/
          └── положения/
              ├── положение-об-отделе-информационных-технологий.md
              └── приложения/
                  ├── схема-структуры.png
                  ├── таблица-оборудования.xlsx
                  └── диаграмма-процессов.jpg
```

## Поддерживаемые форматы файлов

### Графические материалы:
- `.jpg`, `.jpeg` - JPEG изображения
- `.png` - PNG изображения
- `.gif` - GIF изображения
- `.bmp` - BMP изображения
- `.svg` - SVG векторная графика
- `.webp` - WebP изображения

### Таблицы:
- `.xlsx` - Excel (новый формат)
- `.xls` - Excel (старый формат)
- `.csv` - CSV таблицы
- `.ods` - OpenDocument Spreadsheet

### Другие форматы:
- `.pdf` - PDF документы
- `.doc`, `.docx` - Word документы
- `.txt` - Текстовые файлы
- `.rtf` - RTF документы

## Использование в документах

### Ссылки на приложения в Markdown

В тексте документа можно ссылаться на приложения:

```markdown
Структура отдела представлена на схеме (см. [Приложение 1](приложения/схема-структуры.png)).

Данные об оборудовании приведены в [таблице](приложения/таблица-оборудования.xlsx).
```

### Изображения в тексте

Изображения можно вставлять напрямую:

```markdown
![Схема структуры отдела](приложения/схема-структуры.png)
```

## Отображение в веб-интерфейсе

### Автоматический список приложений

Если у документа есть приложения, они автоматически отображаются в отдельном блоке внизу страницы:

- **Изображения** - отображаются как миниатюры с возможностью просмотра в полном размере
- **Таблицы и другие файлы** - отображаются как иконки с возможностью скачивания

### Ссылки в тексте

Все ссылки на приложения в тексте документа автоматически преобразуются в рабочие ссылки для просмотра/скачивания.

## Пример документа с приложениями

```markdown
---
type: положение
organization: ООО ФК "РАНА"
department: Отдел информационных технологий
number: ПОЛ-ОИТ-001
date: 2019-03-18
title: Положение об отделе информационных технологий
status: действующий
---

# Положение об отделе информационных технологий

## 1. Общие положения

1.1. Структура отдела представлена на схеме (см. [Приложение 1](приложения/схема-структуры.png)).

1.2. Перечень оборудования приведен в [Приложении 2](приложения/таблица-оборудования.xlsx).

![Схема структуры отдела](приложения/схема-структуры.png)
```

## API

### Просмотр приложения

```
GET /attachment/{doc_path}/{attachment_path}
```

Пример:
```
GET /attachment/ООО ФК РАНА/Отдел информационных технологий/положения/положение-об-отделе-информационных-технологий/приложения/схема.png
```

## Безопасность

- Все пути к приложениям проверяются на безопасность
- Доступ разрешен только к файлам в директории документа
- Запрещен доступ к файлам вне директории документа (защита от path traversal)

## Рекомендации

1. **Используйте понятные имена файлов** - это упростит навигацию
2. **Оптимизируйте изображения** - используйте подходящие форматы и размеры
3. **Организуйте файлы** - группируйте связанные приложения
4. **Документируйте приложения** - указывайте в тексте документа, что содержит каждое приложение

